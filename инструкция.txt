sudo apt update && sudo apt upgrade -y
sudo apt install -y git python3-pip snapd python3.12-venv
sudo snap install firefox
apt install unzip
sudo mkdir -p /ai-moder
python3.12 -m venv /ai-moder/venv
source /ai-moder/venv/bin/activate
sudo dpkg -i opera-stable_87.0.4390.36_amd64.deb
sudo apt-get install -f


wget https://github.com/operasoftware/operachromiumdriver/releases/download/v.132.0.6834.209/operadriver_linux64.zip
unzip operadriver_linux64.zip
sudo mv operadriver_linux64/operadriver venv/bin/operadriver
sudo chmod +x venv/bin/operadriver


pip install mss google-generativeai PyTelegramBotAPI deep-translator selenium opencv-python pandas pillow aiohttp numpy
sudo mkdir -p /ai-moder/server.git
cd /ai-moder/server.git
git init --bare
sudo tee hooks/post-receive > /dev/null << 'EOF'
git --work-tree=/ai-moder --git-dir=/ai-moder/server.git checkout -f main
EOF
sudo chmod +x hooks/post-receive
sudo tee /etc/systemd/system/aimoder.service > /dev/null << 'EOF'
[Unit]
Description=AI Moderation Bot
After=network.target

[Service]
ExecStart=/ai-moder/venv/bin/python /ai-moder/bot_test.py
WorkingDirectory=/ai-moder
Restart=always

[Install]
WantedBy=multi-user.target
EOF

sudo systemctl daemon-reload
sudo systemctl enable aimoder
sudo systemctl start aimoder
